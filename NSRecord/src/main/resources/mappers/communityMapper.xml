<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="communityMapper">

	<select id="freeBoardList" resultType="com.nsrecord.dto.FreeBoardDto">
	SELECT B_SEQ,
		   U_SEQ,
		   B_TITLE,
		   B_REPLY,
		   TO_CHAR(B_DATE, 'YYYY-MM-DD-HH24:MI:SS') AS B_DATE,
		   B_COUNT,
		   U_NICKNAME,
		   B_STATUS
	FROM BOARD
	ORDER BY B_SEQ DESC	
	</select>
	
	<select id="freeBoardContent" parameterType="int" resultType="com.nsrecord.dto.FreeBoardDto">
	SELECT B_SEQ,
		   B_TITLE,
		   TO_CHAR(B_DATE, 'YYYY-MM-DD-HH24:MI:SS') AS B_DATE,
		   B_COUNT,
		   U_NICKNAME,
		   B_CONTENT
	FROM BOARD
	WHERE B_SEQ = #{b_seq}	
	</select>
	
	<insert id="freeBoardWriteEnd" parameterType="java.util.HashMap">
		INSERT INTO BOARD
		(B_SEQ, U_SEQ, U_NICKNAME, B_TITLE, B_CONTENT, B_DATE)
		VALUES
		(BOARD_SEQ.NEXTVAL, #{u_seq}, #{u_nickname}, #{b_title}, #{b_content}, SYSDATE)
	</insert>

	<update id="updateFreeBoardContentEnd" parameterType="java.util.HashMap">
		UPDATE BOARD
		SET
			B_TITLE = #{b_title},
			B_CONTENT = #{b_content}
		WHERE B_SEQ = #{b_seq}
	
	</update>
	
	<delete id="deleteFreeBoardContent" parameterType="int">
		DELETE FROM BOARD
		WHERE B_SEQ = #{b_seq}	
	</delete>
	
	<insert id="insertReply" parameterType="java.util.HashMap">
	INSERT INTO REPLY
		(R_SEQ, U_SEQ, U_NICKNAME, R_CONTENT, R_DATE, B_SEQ)
		VALUES
		(R_SEQ.NEXTVAL, #{u_seq}, #{u_nickname}, #{r_content}, SYSDATE, #{b_seq})
	</insert>
	
	<select id="replyContent" resultType="com.nsrecord.dto.FreeBoardDto">
		SELECT B_SEQ,
		       U_SEQ,
		       TO_CHAR(R_DATE, 'YYYY-MM-DD-HH24:MI:SS') AS R_DATE,
		       U_NICKNAME,
		       R_CONTENT,
		       R_SEQ
		FROM REPLY
		WHERE B_SEQ = #{b_seq}
		ORDER BY R_SEQ DESC		
	</select>
	
	<delete id="deleteReply" parameterType="int">
		DELETE FROM REPLY
		WHERE R_SEQ = #{r_seq}	
	</delete>
	
	
</mapper>